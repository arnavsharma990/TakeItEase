<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Take It Ease - AI Buddy</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #c084fc;
            --light: #f3f4f6;
            --dark: #1f2937;
            --success: #10b981;
            --background: #f9fafb;
            --text: #374151;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .controls {
            display: flex;
            gap: 1rem;
        }

        button {
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .primary-btn {
            background-color: var(--primary);
            color: white;
            gap: 0.5rem;
        }

        .primary-btn:hover {
            background-color: var(--primary-dark);
        }

        .secondary-btn {
            background-color: var(--light);
            color: var(--dark);
            gap: 0.5rem;
        }

        .secondary-btn:hover {
            background-color: #e5e7eb;
        }

        .icon-btn {
            color: var(--dark);
            background-color: var(--light);
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
        }

        .icon-btn:hover {
            background-color: #e5e7eb;
        }

        .icon-btn.active {
            background-color: var(--primary);
            color: white;
        }

        .chat-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            background-color: white;
            border-radius: 1rem;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .chat-header {
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--light);
        }

        .ai-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--success);
        }

        .messages {
            flex-grow: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            display: flex;
            max-width: 80%;
        }

        .user-message {
            margin-left: auto;
            flex-direction: row-reverse;
        }

        .ai-message {
            margin-right: auto;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 0.5rem;
            flex-shrink: 0;
        }

        .user-avatar {
            background-color: var(--light);
            color: var(--dark);
        }

        .ai-avatar {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .message-content {
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            max-width: calc(100% - 60px);
        }

        .user-content {
            background-color: var(--primary);
            color: white;
            border-top-right-radius: 0;
        }

        .ai-content {
            background-color: var(--light);
            color: var(--dark);
            border-top-left-radius: 0;
        }

        .typing-indicator {
            display: flex;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            align-items: center;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: var(--dark);
            border-radius: 50%;
            opacity: 0.6;
            animation: typing 1.4s infinite both;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-4px);
            }
        }

        .input-container {
            display: flex;
            padding: 1rem;
            border-top: 1px solid var(--light);
            gap: 0.75rem;
        }

        .message-input {
            flex-grow: 1;
            padding: 0.75rem 1rem;
            border: 1px solid var(--light);
            border-radius: 0.5rem;
            outline: none;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        .message-input:focus {
            border-color: var(--primary);
        }

        .send-btn {
            background-color: var(--primary);
            color: white;
            width: 2.75rem;
            height: 2.75rem;
            border-radius: 0.5rem;
            flex-shrink: 0;
        }

        .send-btn:hover {
            background-color: var(--primary-dark);
        }

        .send-btn:disabled {
            background-color: var(--light);
            color: #9ca3af;
            cursor: not-allowed;
        }

        .ai-bubble {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 1.5rem;
            box-shadow: var(--shadow);
            cursor: pointer;
            animation: pulse 2s infinite;
            z-index: 100;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(99, 102, 241, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                height: 100vh;
            }

            .message {
                max-width: 90%;
            }
            
            .controls {
                flex-wrap: wrap;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">E</div>
                <h1>Take It Ease</h1>
            </div>
            <div class="controls">
                <button id="homeBtn" class="secondary-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                    Back to Home
                </button>
                <button id="jokeBtn" class="secondary-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>
                    Tell me a joke
                </button>
                <button id="voiceToggleBtn" class="icon-btn active">
                    <svg id="voiceIcon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path></svg>
                </button>
            </div>
        </header>
        
        <div class="chat-container">
            <div class="chat-header">
                <div class="ai-status">
                    <div class="status-dot"></div>
                    <span>Ease is online</span>
                </div>
                <button id="resetBtn" class="icon-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/></svg>
                </button>
            </div>
            
            <div id="messagesContainer" class="messages">
                <!-- Messages will be added here dynamically -->
            </div>
            
            <div class="input-container">
                <input type="text" id="messageInput" class="message-input" placeholder="Type your message here..." aria-label="Type your message">
                <button id="sendBtn" class="send-btn" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Array of jokes for the joke feature
        const jokes = [
            "Why don't scientists trust atoms? Because they make up everything!",
            "I told my wife she was drawing her eyebrows too high. She looked surprised.",
            "What do you call a fake noodle? An impasta!",
            "Why did the scarecrow win an award? Because he was outstanding in his field!",
            "I'm reading a book about anti-gravity. It's impossible to put down!",
            "Why don't eggs tell jokes? They'd crack each other up.",
            "I used to play piano by ear, but now I use my hands.",
            "Why can't you give Elsa a balloon? Because she will let it go.",
            "What's the best thing about Switzerland? I don't know, but the flag is a big plus.",
            "How do you organize a space party? You planet."
        ];

        // Initial responses for common problems
        const problemResponses = {
            "stress": "I understand dealing with stress can be challenging. Would you like to talk more about what's causing your stress? Sometimes just talking about it can help provide clarity.",
            "anxiety": "Anxiety can be really tough to deal with. Remember to take deep breaths when you're feeling anxious. Would it help to talk through what's making you feel anxious right now?",
            "lonely": "I'm sorry you're feeling lonely. That's a difficult emotion to process. What kinds of things usually help you feel more connected to others?",
            "tired": "Being tired can affect everything in your life. Have you been getting enough rest lately? What might be causing you to feel drained?",
            "work": "Work challenges can be really frustrating. What specific aspects of work are bothering you the most right now?",
            "relationship": "Relationships can be complex and sometimes difficult. Would you like to share more about what's happening? I'm here to listen."
        };

        // DOM elements
        const messagesContainer = document.getElementById('messagesContainer');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const voiceToggleBtn = document.getElementById('voiceToggleBtn');
        const voiceIcon = document.getElementById('voiceIcon');
        const jokeBtn = document.getElementById('jokeBtn');
        const resetBtn = document.getElementById('resetBtn');
        const homeBtn = document.getElementById('homeBtn');

        // State variables
        let isVoiceEnabled = true; // Default to enabled
        let isAITyping = false;
        let conversationHistory = [];

        // Initialize speech synthesis
        const speechSynthesis = window.speechSynthesis;
        let voices = [];

        // Get available voices
        function loadVoices() {
            voices = speechSynthesis.getVoices();
        }

        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        loadVoices();

        // Speak text function
        function speakText(text) {
            if (!isVoiceEnabled) return;
            
            // Cancel any ongoing speech
            speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            
            // Find a good voice (preferably female for "Ease")
            const voice = voices.find(v => v.name.includes('Female') || v.name.includes('Google') || v.lang === 'en-US') || voices[0];
            
            if (voice) {
                utterance.voice = voice;
            }
            
            utterance.pitch = 1.1;
            utterance.rate = 1.0;
            utterance.volume = 1.0;
            
            speechSynthesis.speak(utterance);
        }

        // Add a message to the UI
        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const avatarDiv = document.createElement('div');
            avatarDiv.className = `message-avatar ${sender}-avatar`;
            avatarDiv.innerHTML = sender === 'user' ? 
                '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>' : 
                'E';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = `message-content ${sender}-content`;
            contentDiv.textContent = text;
            
            messageDiv.appendChild(avatarDiv);
            messageDiv.appendChild(contentDiv);
            
            messagesContainer.appendChild(messageDiv);
            
            // Save to conversation history
            conversationHistory.push({ sender, text });
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Speak AI messages if voice is enabled
            if (sender === 'ai' && isVoiceEnabled) {
                speakText(text);
            }
        }

        // Show typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message ai-message typing-indicator';
            typingDiv.id = 'typingIndicator';
            
            const avatarDiv = document.createElement('div');
            avatarDiv.className = 'message-avatar ai-avatar';
            avatarDiv.innerHTML = 'E';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content ai-content';
            
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                dot.className = 'typing-dot';
                contentDiv.appendChild(dot);
            }
            
            typingDiv.appendChild(avatarDiv);
            typingDiv.appendChild(contentDiv);
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Get AI response based on user input
        function getAIResponse(userText) {
            // Basic pattern matching for common issues
            const userTextLower = userText.toLowerCase();
            
            // Check for common problem keywords
            for (const [keyword, response] of Object.entries(problemResponses)) {
                if (userTextLower.includes(keyword)) {
                    return response;
                }
            }
            
            // Handle greetings
            if (userTextLower.match(/^(hi|hello|hey|greetings)/)) {
                return "Hello there! How are you feeling today? I'm here to listen if you want to talk about anything.";
            }
            
            // Handle questions about the AI
            if (userTextLower.includes("who are you") || userTextLower.includes("what are you")) {
                return "I'm Ease, your AI buddy from Take It Ease. I'm here to listen, chat, and maybe even tell a joke or two if that would help!";
            }
            
            // Handle thanks
            if (userTextLower.match(/(thank|thanks)/)) {
                return "You're very welcome! I'm glad I could help.";
            }
            
            // Handle goodbyes
            if (userTextLower.match(/(bye|goodbye|see you|farewell)/)) {
                return "Take care! Remember I'm here whenever you need to talk. Wishing you well!";
            }
            
            // Default responses for when no pattern matches
            const defaultResponses = [
                "Tell me more about that. I'm here to listen.",
                "How does that make you feel?",
                "That's interesting. Could you elaborate a bit more?",
                "I'm here to support you. What would help you most right now?",
                "I understand. Would you like to talk more about this?",
                "Thank you for sharing that with me. How can I best support you?",
                "I'm listening. Feel free to share whatever's on your mind."
            ];
            
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        // Send message function
        function sendMessage() {
            const text = messageInput.value.trim();
            if (text === '' || isAITyping) return;
            
            // Add user message to UI
            addMessage(text, 'user');
            
            // Clear input
            messageInput.value = '';
            sendBtn.disabled = true;
            
            // Show AI is typing
            isAITyping = true;
            showTypingIndicator();
            
            // Simulate AI thinking and typing
            setTimeout(() => {
                removeTypingIndicator();
                const response = getAIResponse(text);
                addMessage(response, 'ai');
                isAITyping = false;
            }, 1500); // Delay to simulate typing
        }

        // Tell a joke function
        function tellJoke() {
            if (isAITyping) return;
            
            isAITyping = true;
            showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator();
                const randomJoke = jokes[Math.floor(Math.random() * jokes.length)];
                addMessage(randomJoke, 'ai');
                isAITyping = false;
            }, 1000);
        }

        // Toggle voice function
        function toggleVoice() {
            isVoiceEnabled = !isVoiceEnabled;
            
            if (isVoiceEnabled) {
                voiceToggleBtn.classList.add('active');
                voiceIcon.innerHTML = '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>';
                addMessage("Voice responses are now enabled.", 'ai');
            } else {
                voiceToggleBtn.classList.remove('active');
                voiceIcon.innerHTML = '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line>';
                addMessage("Voice responses are now disabled.", 'ai');
                
                // Stop any ongoing speech
                speechSynthesis.cancel();
            }
        }

        // Reset conversation function
        function resetConversation() {
            // Clear messages
            messagesContainer.innerHTML = '';
            conversationHistory = [];
            
            // Add welcome message
            setTimeout(() => {
                addMessage("Hi there! I'm Ease, your friendly AI buddy. How can I help you today?", 'ai');
            }, 300);
        }

        // Go to home page function
        function goToHome() {
            // Redirect specifically to home.html
            window.location.href = "home.html";
        }

        // Event listeners
        messageInput.addEventListener('input', () => {
            sendBtn.disabled = messageInput.value.trim() === '';
        });

        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !sendBtn.disabled) {
                sendMessage();
            }
        });

        sendBtn.addEventListener('click', sendMessage);
        jokeBtn.addEventListener('click', tellJoke);
        voiceToggleBtn.addEventListener('click', toggleVoice);
        resetBtn.addEventListener('click', resetConversation);
        homeBtn.addEventListener('click', goToHome);

        // Initialize with welcome message
        window.addEventListener('DOMContentLoaded', () => {
            addMessage("Hi there! I'm Ease, your friendly AI buddy. How can I help you today?", 'ai');
        });
    </script>
</body>
</html>